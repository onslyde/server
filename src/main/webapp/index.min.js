"use strict";function renderChart(chartsDefaults,chartdata){var newSettings={};$.extend(!0,newSettings,chartsDefaults,chartdata);new Highcharts.Chart(newSettings)}var onslyde=onslyde||{};onslyde.Constants=angular.module("onslyde.constants",[]),onslyde.Services=angular.module("onslyde.services",[]),onslyde.Controllers=angular.module("onslyde.controllers",[]),onslyde.Filters=angular.module("onslyde.filters",[]),onslyde.Directives=angular.module("onslyde.directives",[]),angular.module("onslyde",["ngResource","ngRoute","localStorage","onslyde.filters","onslyde.services","onslyde.directives","onslyde.constants","onslyde.controllers"]).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$routeProvider.when("/home",{templateUrl:"home/home.html",controller:"PageCtrl"}).when("/login",{templateUrl:"global/login.html",controller:"LoginCtrl"}).when("/gettingstarted",{templateUrl:"gettingstarted/gettingstarted.html",controller:"GetStartedCtrl"}).when("/register",{templateUrl:"home/register.html",controller:"PageCtrl"}).when("/analytics",{templateUrl:"analytics/analytics.html",controller:"AnalyticsCtrl"}).when("/analytics/edge2013",{templateUrl:"analytics/edgeNY-2013.html",controller:"AnalyticsCtrl"}).otherwise({redirectTo:"/home"}),$locationProvider.html5Mode(!1).hashPrefix("!")}]).run(function($rootScope,$location){$rootScope.$on("$viewContentLoaded",function(){angular.element(document).ready(function(){var tag=document.createElement("script");tag.src="//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),window.runFoundation(window,document,void 0),window.runOrbit(window,document,void 0),window.runReveal(window,document,void 0),window.runTooltip(window,document,void 0),$(document).foundation(),$("#how-can-use").on("orbit:after-slide-change",function(event,orbit){var counter=1;angular.forEach(document.querySelectorAll(".slide"),function(value){orbit.slide_number+1===counter?(value.classList.remove("hidden"),value.classList.add("slide"+counter)):(value.classList.add("hidden"),value.classList.remove("slide"+counter)),counter++})}),$location.hash()&&$anchorScroll($location.hash())})})}),onslyde.Controllers.controller("AnalyticsCtrl",["pagedata","chartservice","$scope","$rootScope","$routeParams","$timeout","youtubeapi","$q",function(pagedata,chartservice,$scope,$rootScope,$routeParams,$timeout,youtubeapi,$q){$scope.sessionID=$routeParams.sessionID,$scope.presAnalyticsSetup=function(){pagedata.get(null,$rootScope.urls()+"/go/analytics/list/"+$rootScope.userInfo.id).then(function(success){$scope.sessionList=success},function(fail){console.log("Problem getting session list",fail)})},$scope.panelAnalyticsSetup=function(){function getSpeakerSummaryData(speakerTotals,twooptions){var spearkerStat={topic:twooptions.topicName,agree:0,disagree:0,sessions:0,speaker:twooptions.speakerData};if(speakerTotals.length>0)for(var d=0;d<speakerTotals.length;d++)if(speakerTotals[d].topic===twooptions.topicName){spearkerStat=speakerTotals.splice(d,1)[0];break}return spearkerStat}var dataDescription={timeseries:{yAxisLabels:[""],labels:["Total"],dataAttr:["label",["timestamp","count"]],colors:["rgba(43,166,203,0.9)","rgba(52,52,52,0.3)","rgba(169,234,181,0.9)","rgba(43,43,43,0.5)"],borderColor:"#1b97d1"},pie:{dataAttr:["label",["timestamp","count"]],colors:["rgba(43,166,203,0.4)","rgba(52,52,52,0.3)","rgba(169,234,181,0.5)","rgba(43,43,43,0.5)","#ff9191","#ffa1a1","#ffb6b6","#ffcbcb"],borderColor:"#ff0303"}};$scope.createCharts=function(){pagedata.get(null,$rootScope.urls()+"/go/analytics/"+$routeParams.sessionID).then(function(success){function createCharts(){var overViewOptions=[];angular.forEach($scope.sessionData.slideGroups,function(value){var twooptions,voteData,voteOptions,allVotes;if(value.slideGroupOptionses.length>2){twooptions=[{label:"",datapoints:[]},{label:"",datapoints:[]},{label:"",datapoints:[]},{label:"",datapoints:[]}],allVotes=[{label:"",datapoints:[]},{label:"",datapoints:[]},{label:"",datapoints:[]},{label:"",datapoints:[]}],voteData=value.slideGroupVoteses,voteOptions=value.slideGroupOptionses,twooptions.topicName=value.groupName;try{twooptions.topicImage=value.slides[0].screenshot}catch(e){}}else twooptions=[{label:"",datapoints:[]},{label:"",datapoints:[]}],allVotes=[{label:"",datapoints:[]},{label:"",datapoints:[]}],"undefined"!=typeof value.slides[0]&&(voteData=value.slides[0].slideVoteses,voteOptions=value.slides[0].slideOptionses,twooptions.yo=value.slides[0],twooptions.topicName=value.slides[0].slideIndex,twooptions.topicImage=value.slides[0].screenshot,twooptions.topicID=value.slides[0].id);if(twooptions.created=value.created,twooptions.sessionID=$routeParams.sessionID,twooptions.speakerData=$scope.getPanelist($routeParams.sessionID,twooptions.topicName),voteData&&voteData.length>=$scope.dashBoard.sessionVotesFilter.value){for(var spearkerStat=getSpeakerSummaryData($scope.dashBoard.speakerTotals,twooptions),optionTracker={},slideOptions=voteOptions,i=0;i<slideOptions.length;i++)twooptions[i].label=slideOptions[i].name,allVotes[i].label=slideOptions[i].name,optionTracker[slideOptions[i].name]=0,twooptions[i].datapoints.push({timestamp:0,count:0});angular.forEach(voteData,function(vote){{var thisSlideOptions,voteTime=vote.voteTime;vote.attendee}thisSlideOptions=2===twooptions.length?vote.slideOptions:vote.slideGroupOptions;for(var i=0;i<twooptions.length;i++){var dataPoints=twooptions[i].datapoints,totalLength=dataPoints[dataPoints.length-1];twooptions[i].label===thisSlideOptions.name?(0===optionTracker[twooptions[i].label]&&0===totalLength.timestamp?(twooptions[i].datapoints[0]={timestamp:voteTime,count:1},optionTracker[twooptions[i].label]=1):(0===optionTracker[twooptions[i].label]&&(optionTracker[twooptions[i].label]=1),twooptions[i].datapoints.push({timestamp:voteTime,count:optionTracker[twooptions[i].label]++})),$scope.dashBoard.totals[twooptions[i].label]+=1,allVotes[i].datapoints.push({timestamp:voteTime,count:1})):(0===optionTracker[twooptions[i].label]&&0===totalLength.timestamp?twooptions[i].datapoints[0]={timestamp:voteTime,count:optionTracker[twooptions[i].label]}:twooptions[i].datapoints.push({timestamp:voteTime,count:optionTracker[twooptions[i].label]}),allVotes[i].datapoints.push({timestamp:voteTime,count:0})),twooptions[i].datapoints.sort(function(a,b){return a=a.timestamp,b=b.timestamp,a>b?1:b>a?-1:0})}});for(var i=0;i<twooptions.length;i++)spearkerStat[twooptions[i].label]+=twooptions[i].datapoints[twooptions[i].datapoints.length-1].count;spearkerStat.sessions+=1,$scope.dashBoard.speakerTotals.push(spearkerStat),twooptions&&(overViewOptions.push(twooptions[0]),overViewOptions.push(twooptions[1]));var startTime=$rootScope.sessionData.end,tempLineChart=angular.copy($rootScope.chartTemplate.line),tempPieChart=angular.copy($rootScope.chartTemplate.pie);twooptions.chartData=chartservice.convertLineChart(twooptions,tempLineChart,dataDescription.timeseries,""),twooptions.pieChartData=chartservice.convertPieChart(twooptions,tempPieChart,dataDescription.pie,"");var createYoutubeClickable=function(series){series.point={events:{click:function(){$("#chart_movie").foundation("reveal","open"),$("#chart_movie").bind("close",function(){youtubeapi.player.pauseVideo()}),youtubeapi.player.seekTo((this.category-startTime)/1e3),youtubeapi.player.playVideo()}}}};$rootScope.sessionData.sessionCode&&"panel"===$rootScope.sessionData.extra&&(createYoutubeClickable(twooptions.chartData.series[0]),createYoutubeClickable(twooptions.chartData.series[1])),$scope.twoOptionsList.push(twooptions)}});var tempOverViewChart=angular.copy($rootScope.chartTemplate.line);$scope.overViewOptions=chartservice.convertLineChart(overViewOptions,tempOverViewChart,dataDescription.timeseries,"")}$rootScope.sessionData=success,$scope.twoOptionsList=[],$scope.dashBoard={},$scope.dashBoard.totals={agree:1,disagree:1},$scope.dashBoard.speakerTotals=[],$scope.dashBoard.sessionVotesFilterList=[{value:1},{value:2},{value:3},{value:4},{value:5},{value:6},{value:7},{value:8},{value:9},{value:10}],$scope.dashBoard.sessionVotesFilter=$scope.dashBoard.sessionVotesFilterList[1],$scope.$watch("dashBoard.sessionVotesFilter",function(newVal,oldVal){newVal!==oldVal&&($scope.twoOptionsList=[],$scope.dashBoard.totals={agree:1,disagree:1},$scope.dashBoard.speakerTotals=[],createCharts())}),createCharts()},function(fail){console.log("Problem getting chart datapoints",fail)})},$rootScope.chartTemplate?$scope.createCharts():pagedata.get(null,"charts/highcharts.json").then(function(success){$rootScope.chartTemplate=success,$scope.createCharts()},function(fail){console.log("Problem getting chart template",fail)});var panelistjson;$scope.getPanelist=function(sessionID,name){var result,allpanels,deferred=$q.defer();panelistjson||pagedata.get(null,"/analytics/json/edge/edge1.json").then(function(success){panelistjson=success.panelists,deferred.resolve(success.panelists)},function(fail){deferred.reject(fail)}),deferred.promise.then(function(){return angular.forEach(allpanels,function(value){value.name===name&&(result=value)}),result})}}}]),onslyde.Directives.directive("chart",function(){return{restrict:"E",scope:{chartdata:"=chartdata"},template:"<div></div>",replace:!0,controller:function(){},link:function(scope,element,attrs){scope.$watch("chartdata",function(chartdata){if(chartdata){var chartsDefaults={chart:{renderTo:element[0],type:attrs.type||null,height:attrs.height||null,width:attrs.width||null,reflow:!0,animation:!1,zoomType:"x"}};if("pie"===attrs.type&&(chartsDefaults.chart.margin=[0,0,0,0],chartsDefaults.chart.spacingLeft=0,chartsDefaults.chart.spacingRight=0,chartsDefaults.chart.spacingTop=0,chartsDefaults.chart.spacingBottom=0,attrs.titleimage&&(chartdata.title.text='<img src="'+attrs.titleimage+'">'),attrs.titleicon&&(chartdata.title.text='<i class="pictogram title">'+attrs.titleicon+"</i>"),attrs.titlecolor&&(chartdata.title.style.color=attrs.titlecolor),attrs.titleimagetop&&(chartdata.title.style.marginTop=attrs.titleimagetop),attrs.titleimageleft&&(chartdata.title.style.marginLeft=attrs.titleimageleft)),"line"===attrs.type&&(chartsDefaults.chart.marginTop=30,chartsDefaults.chart.spacingTop=50),"column"===attrs.type&&(chartsDefaults.chart.marginBottom=80),"area"===attrs.type&&(chartsDefaults.chart.spacingLeft=0,chartsDefaults.chart.spacingRight=0,chartsDefaults.chart.marginLeft=0,chartsDefaults.chart.marginRight=0),Highcharts.setOptions({global:{useUTC:!1},chart:{style:{fontFamily:"Lato, Helvetica, Arial, sans-serif"}}}),"line"===attrs.type){var xAxis1=chartdata.xAxis[0];xAxis1.labels.formatter||(xAxis1.labels.formatter=new Function(attrs.xaxislabel)),xAxis1.labels.step||(xAxis1.labels.step=attrs.xaxisstep)}chartdata.tooltip&&"string"==typeof chartdata.tooltip.formatter&&(chartdata.tooltip.formatter=new Function(chartdata.tooltip.formatter)),renderChart(chartsDefaults,chartdata)}})}}}),onslyde.Services.factory("chartservice",function(){var areaChart,paretoChart,pieChart,xaxis,seriesIndex;return{convertLineChart:function(chartData,chartTemplate,dataDescription,settings){var label,lineChart=(chartData.length,chartTemplate);if(seriesIndex=0,lineChart.series=[],label="",xaxis=lineChart.xAxis[0],settings.xaxisformat&&(xaxis.labels.formatter=new Function(settings.xaxisformat)),settings.step&&(xaxis.labels.step=settings.step),chartData.length>1)for(var l=0;l<chartData.length;l++){chartData.sort(function(a,b){return a=a.label.toLowerCase(),b=b.label.toLowerCase(),"agree"===a?-1:"agree"===b?1:"disagree"===a?-1:"disagree"===b?1:a>b?1:b>a?-1:0});var dataPoints=chartData[l].datapoints;lineChart.series[l]={},lineChart.series[l].data=[],lineChart.series[l].name=chartData[l].label,lineChart.series[l].yAxis=0,lineChart.series[l].type="line",lineChart.series[l].color=dataDescription.colors[l],lineChart.series[l].dashStyle="solid";for(var i=0;i<dataPoints.length;i++)"object"==typeof dataDescription.dataAttr[1]&&lineChart.series[l].data.push([dataPoints[i].timestamp,dataPoints[i].count])}return lineChart},convertAreaChart:function(chartData,chartTemplate,dataDescription,settings,currentCompare){function plotData(counter,dPLength,dataPoints,dataAttrs,detailedView){for(var i=0;dPLength>i;i++)for(var dp=dataPoints[i],localCounter=counter,j=0;j<dataAttrs.length;j++)areaChart.series[localCounter].data.push("undefined"==typeof dp?0:dp[dataAttrs[j]]),detailedView||localCounter++}areaChart=angular.copy(areaChart),"undefined"==typeof chartData[0]&&(chartData[0]={},chartData[0].datapoints=[]);var label,dataPoints=chartData[0].datapoints,dPLength=dataPoints.length;"YESTERDAY"===currentCompare?(seriesIndex=dataDescription.dataAttr.length,label="Yesterday "):"LAST_WEEK"===currentCompare?(seriesIndex=dataDescription.dataAttr.length,label="Last Week "):(areaChart=chartTemplate,seriesIndex=0,areaChart.series=[],label=""),xaxis=areaChart.xAxis[0],xaxis.categories=[],settings.xaxisformat&&(xaxis.labels.formatter=new Function(settings.xaxisformat)),settings.step&&(xaxis.labels.step=settings.step);for(var i=0;dPLength>i;i++){var dp=dataPoints[i];xaxis.categories.push(dp.timestamp)}if(chartData.length>1)for(var l=0;l<chartData.length;l++)chartData[l].chartGroupName&&(dataPoints=chartData[l].datapoints,areaChart.series[l]={},areaChart.series[l].data=[],areaChart.series[l].fillColor=dataDescription.areaColors[l],areaChart.series[l].name=chartData[l].chartGroupName,areaChart.series[l].yAxis=0,areaChart.series[l].type="area",areaChart.series[l].pointInterval=1,areaChart.series[l].color=dataDescription.colors[l],areaChart.series[l].dashStyle="solid",areaChart.series[l].yAxis.title.text=dataDescription.yAxisLabels,plotData(l,dPLength,dataPoints,dataDescription.detailDataAttr,!0));else{for(var steadyCounter=0,i=seriesIndex;i<dataDescription.dataAttr.length+(seriesIndex>0?seriesIndex:0);i++){var yAxisIndex=dataDescription.multiAxis?steadyCounter:0;areaChart.series[i]={},areaChart.series[i].data=[],areaChart.series[i].fillColor=dataDescription.areaColors[i],areaChart.series[i].name=label+dataDescription.labels[steadyCounter],areaChart.series[i].yAxis=yAxisIndex,areaChart.series[i].type="area",areaChart.series[i].pointInterval=1,areaChart.series[i].color=dataDescription.colors[i],areaChart.series[i].dashStyle="solid",areaChart.yAxis[yAxisIndex].title.text=dataDescription.yAxisLabels[dataDescription.yAxisLabels>1?steadyCounter:0],steadyCounter++}plotData(seriesIndex,dPLength,dataPoints,dataDescription.dataAttr,!1)}return areaChart},convertParetoChart:function(chartData,chartTemplate,dataDescription,settings,currentCompare){function getPreviousData(){for(var i=0;i<chartTemplate.series[0].data.length;i++)allParetoOptions.push(chartTemplate.xAxis.categories[i])}function createStackedBar(dataDescription,paretoChart){paretoChart.plotOptions={series:{shadow:!1,borderColor:dataDescription.borderColor,borderWidth:1},column:{stacking:"normal",dataLabels:{enabled:!0,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white"}}};var start=dataDescription.dataAttr[1].length,steadyCounter=0;stackName=label,compare&&(paretoChart.legend.enabled=!0);for(var f=seriesIndex;start+seriesIndex>f;f++)paretoChart.series[f]||(paretoChart.series[f]={data:[]}),paretoChart.series[f].data.push(bar[dataDescription.dataAttr[1][steadyCounter]]),paretoChart.series[f].name=""!==label?label+" "+dataDescription.labels[steadyCounter]:dataDescription.labels[steadyCounter],paretoChart.series[f].color=dataDescription.colors[f],paretoChart.series[f].stack=label,steadyCounter++}"undefined"==typeof chartData&&(chartData=[]);var label,cdLength=chartData.length,compare=!1,allParetoOptions=[],stackedBar=!1;if(paretoChart=chartTemplate,seriesIndex=0,"object"==typeof dataDescription.dataAttr[1]&&(stackedBar=!0),"YESTERDAY"===currentCompare?(label="Yesterday ",compare=!0,stackedBar&&(seriesIndex=dataDescription.dataAttr[1].length),getPreviousData()):"LAST_WEEK"===currentCompare?(label="Last Week ",compare=!0,stackedBar&&(seriesIndex=dataDescription.dataAttr[1].length),seriesIndex=getPreviousData()):(compare=!1,label="",paretoChart.xAxis.categories=[],paretoChart.series=[],paretoChart.series[0]={},paretoChart.series[0].data=[],paretoChart.legend.enabled=!1),paretoChart.plotOptions.series.borderColor=dataDescription.borderColor,compare&&!stackedBar){paretoChart.series[1]={},paretoChart.series[1].data=[];for(var i=0;i<allParetoOptions.length;i++)paretoChart.series[1].data.push(0);paretoChart.legend.enabled=!0}for(var i=0;cdLength>i;i++){var bar=chartData[i];if(compare){var newLabel=bar[dataDescription.dataAttr[0]],newValue=bar[dataDescription.dataAttr[1]],previousIndex=allParetoOptions.indexOf(newLabel);previousIndex>-1&&("object"==typeof dataDescription.dataAttr[1]?createStackedBar(dataDescription,paretoChart,paretoChart.series.length):(paretoChart.series[1].data[previousIndex]=newValue,paretoChart.series[1].name=""!==label?label+" "+dataDescription.labels[0]:dataDescription.labels[0],paretoChart.series[1].color=dataDescription.colors[1]))}else paretoChart.xAxis.categories.push(bar[dataDescription.dataAttr[0]]),"object"==typeof dataDescription.dataAttr[1]?createStackedBar(dataDescription,paretoChart,paretoChart.series.length):(paretoChart.series[0].data.push(bar[dataDescription.dataAttr[1]]),paretoChart.series[0].name=dataDescription.labels[0],paretoChart.series[0].color=dataDescription.colors[0])}return paretoChart},convertPieChart:function(chartData,chartTemplate,dataDescription){var cdLength=chartData.length,compare=!1;pieChart=chartTemplate,compare=!1,pieChart.series[0].data=[],pieChart.series[0].dataLabels&&"string"==typeof pieChart.series[0].dataLabels.formatter&&(pieChart.series[0].dataLabels.formatter=new Function(pieChart.series[0].dataLabels.formatter)),pieChart.plotOptions.pie.borderColor=dataDescription.borderColor;for(var tempArray=[],i=0;cdLength>i;i++){var pie=chartData[i];tempArray.push({name:pie[dataDescription.dataAttr[0]],y:pie.datapoints[pie.datapoints.length-1][dataDescription.dataAttr[1][1]],color:""})}tempArray.sort(function(a,b){return a=a.name.toLowerCase(),b=b.name.toLowerCase(),a>b?1:b>a?-1:0});for(var i=0;i<tempArray.length;i++)tempArray[i].color=dataDescription.colors[i];return pieChart.series[0].data=tempArray,pieChart}}}),angular.module("localStorage",["ngCookies"]).factory("$store",["$parse","$cookieStore","$window","$log",function($parse,$cookieStore,$window,$log){var storage="undefined"==typeof $window.localStorage?void 0:$window.localStorage,supported=!("undefined"==typeof storage||"undefined"==typeof $window.JSON),privateMethods={parseValue:function(res){var val;try{val=$window.JSON.parse(res),"undefined"==typeof val&&(val=res),"true"===val&&(val=!0),"false"===val&&(val=!1),$window.parseFloat(val)!==val||angular.isObject(val)||(val=$window.parseFloat(val))}catch(e){val=res}return val}},publicMethods={set:function(key,value){if(!supported)try{return $cookieStore.put(key,value),value}catch(e){$log.log("Local Storage not supported, make sure you have angular-cookies enabled.")}var saver=$window.JSON.stringify(value);return storage.setItem(key,saver),privateMethods.parseValue(saver)},get:function(key){if(!supported)try{return privateMethods.parseValue($.cookie(key))}catch(e){return null}var item=storage.getItem(key);return privateMethods.parseValue(item)},remove:function(key){if(!supported)try{return $cookieStore.remove(key),!0}catch(e){return!1}return storage.removeItem(key),!0},bind:function($scope,key,opts){var defaultOpts={defaultValue:"",storeName:""};opts=angular.isString(opts)?angular.extend({},defaultOpts,{defaultValue:opts}):angular.isUndefined(opts)?defaultOpts:angular.extend(defaultOpts,opts);var storeName=opts.storeName||key;return publicMethods.get(storeName)||publicMethods.set(storeName,opts.defaultValue),$parse(key).assign($scope,publicMethods.get(storeName)),$scope.$watch(key,function(val){angular.isDefined(val)&&publicMethods.set(storeName,val)},!0),publicMethods.get(storeName)},unbind:function($scope,key,storeName){storeName=storeName||key,$parse(key).assign($scope,null),$scope.$watch(key,function(){}),publicMethods.remove(storeName)},clearAll:function(){storage.clear()}};return publicMethods}]),onslyde.Controllers.controller("LoginCtrl",["$store","$http","$scope","$rootScope","$routeParams","$location",function($store,$http,$scope,$rootScope,$routeParams,$location){$store.bind($rootScope,"userInfo"),$scope.loginButton={label:"Sign In",disabled:!1},$scope.login=function(email,password){$scope.loginButton.label="Signing in...",$scope.loginButton.disabled=!0;var email=email||$scope.login.email,password=password||$scope.login.password;$http({method:"POST",url:$rootScope.urls()+"/go/members/login",data:$.param({email:email,password:password}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data){data.created?($("#signin").foundation("reveal","close"),$rootScope.userInfo=data,$store.set("userInfo",$rootScope.userInfo),$store.bind($rootScope,"userInfo")):$scope.loginAlert="There was a problem logging in: "+data.name,$scope.loginButton.label="Sign In",$scope.loginButton.disabled=!1}).error(function(){$scope.loginAlert="Wrong password or user not found.",$scope.loginButton.label="Sign In",$scope.loginButton.disabled=!1})},$scope.register={},$scope.registerMessage="",$scope.signupButton={label:"Create",disabled:!1},$scope.registerUser=function(){if($scope.signup.$valid){$scope.signupButton.disabled=!0,$scope.signupButton.label="Creating...";{var email=$scope.register.email,password=$scope.register.password;$scope.register.fullName}$http({method:"POST",url:$rootScope.urls()+"/go/members",data:$scope.register,headers:{}}).success(function(data){$rootScope.registerMessage=data,$store.set("registerMessage",$rootScope.registerMessage),$scope.login(email,password),$location.path("/gettingstarted"),$scope.signupButton.disabled=!1,$scope.signupButton.label="Create"}).error(function(data){$scope.registerAlert="Problem registering user: "+data.email,$scope.signupButton.disabled=!1,$scope.signupButton.label="Create"})}},$scope.logout=function(){$store.remove("userInfo"),$store.remove("registerMessage"),$rootScope.userInfo={},$rootScope.registerMessage={}},$rootScope.$on("userNotAuthenticated",function(){$location.path("/login")}),$scope.$on("loginSuccesful",function(){})}]),onslyde.Controllers.controller("PageCtrl",["pagedata","utility","$scope","$rootScope","$location","$routeParams","$q","$route","$store",function(pagedata,utility,$scope,$rootScope,$location,$routeParams,$q,$route,$store){$scope.location=$location,$rootScope.urls=function(){var BASE_URL="";return BASE_URL="onslyde.com"===$location.host()||"www.onslyde.com"===$location.host()?"https://www.onslyde.com:8443":"https://localhost:8443"},!$rootScope.registerMessage&&$store.get("registerMessage")&&$store.bind($rootScope,"registerMessage"),!$rootScope.userInfo&&$store.get("userInfo")&&$store.bind($rootScope,"userInfo")}]),onslyde.Services.factory("pagedata",function($q,$http,$resource,$rootScope){return{get:function(id,url){var deferred;return deferred=$q.defer(),$http.get(url||configuration.ITEMS_URL).success(function(data){var result;id?angular.forEach(data,function(obj){obj.id===id&&(result=obj)}):result=data,deferred.resolve(result)}).error(function(data,status,headers,config){console.error(data,status,headers,config),deferred.reject(data)}),deferred.promise},getLocal:function(url){var retdata;return $http.get(url).success(function(data){retdata=data}).error(function(data,status,headers,config){console.error(data,status,headers,config)}),retdata},jsonp:function(objectType,criteriaId,params,successCallback){params||(params={}),params.demoApp=$rootScope.demoData?!0:!1,params.access_token=localStorage.getItem("accessToken"),params.callback="JSON_CALLBACK",$http.jsonp($rootScope.urls().DATA_URL+"/"+$rootScope.currentOrg+"/"+$rootScope.currentApp+"/apm/"+objectType+"/"+criteriaId,{params:params,headers:{}}).success(function(data,status,headers,config){successCallback(data,status,headers,config)}).error(function(){console.log("ERROR: Could not get jsonp data. "+$rootScope.urls().DATA_URL+objectType+"/"+criteriaId)})},jsonp_simple:function(objectType,appId,params){params||(params={}),params.access_token=localStorage.getItem("accessToken"),params.callback="JSON_CALLBACK";var deferred=$q.defer();return $http.jsonp($rootScope.urls().DATA_URL+"/"+$rootScope.currentOrg+"/"+$rootScope.currentApp+"/apm/"+objectType+"/"+appId,{params:params}).success(function(data){deferred.resolve(data)}).error(function(data){console.log("ERROR: Could not get jsonp data. "+$rootScope.urls().DATA_URL+"/"+$rootScope.currentOrg+"/"+$rootScope.currentApp+"/apm/"+objectType+"/"+appId),deferred.reject(data)}),deferred.promise},jsonp_raw:function(objectType,appId,params){params||(params={}),params.access_token=localStorage.getItem("accessToken"),params.callback="JSON_CALLBACK";var deferred=$q.defer();return $http.jsonp($rootScope.urls().DATA_URL+"/"+$rootScope.currentOrg+"/"+$rootScope.currentApp+"/"+objectType,{params:params}).success(function(data){deferred.resolve(data)}).error(function(data){console.log("ERROR: Could not get jsonp data. "+$rootScope.urls().DATA_URL+objectType+"/"+appId),deferred.reject(data)}),deferred.promise},resource:function(params,isArray){return $resource($rootScope.urls().DATA_URL+"/:orgname/:appname/:username/:endpoint",{},{get:{method:"JSONP",isArray:isArray,params:params},login:{method:"GET",url:$rootScope.urls().DATA_URL+"/management/token",isArray:!1,params:params},save:{url:$rootScope.urls().DATA_URL+"/"+params.orgname+"/"+params.appname,method:"PUT",isArray:!1,params:params}})}}}),onslyde.Services.factory("utility",function(){return{get_qs_params:function(){var queryParams={};if(window.location.search)for(var params=window.location.search.slice(1).split("&"),i=0;i<params.length;i++){var tmp=params[i].split("=");queryParams[tmp[0]]=unescape(tmp[1])}return queryParams},safeApply:function(fn){var phase=this.$root.$$phase;"$apply"==phase||"$digest"==phase?fn&&"function"==typeof fn&&fn():this.$apply(fn)}}}),onslyde.Directives.directive("youtube",["youtubeapi",function(youtubeapi){return{restrict:"A",link:function(scope,element,attrs){youtubeapi.videoId=attrs.sessionid,youtubeapi.bindVideoPlayer(element[0].id),youtubeapi.loadPlayer()}}}]),onslyde.Services.factory("youtubeapi",function($window,$rootScope,$log,$timeout){var service=$rootScope;return $window.onYouTubeIframeAPIReady=function(){$log.info("Youtube API is ready"),service.ready=!0},service.ready=!1,service.playerId=null,service.player=null,service.videoId=null,service.playerHeight="390",service.playerWidth="640",service.bindVideoPlayer=function(elementId){service.playerId=elementId},service.createPlayer=function(){return new YT.Player(this.playerId,{height:this.playerHeight,width:this.playerWidth,videoId:this.videoId,events:{onReady:$window.onPlayerReady}})},service.loadPlayer=function(){var that=this;$timeout(function(){that.ready&&that.playerId&&that.videoId&&(that.player&&that.player.destroy(),that.player=that.createPlayer())},2e3)},service}),onslyde.Controllers.controller("GetStartedCtrl",["$scope","$rootScope","$location","$http","$store",function($scope,$rootScope,$location,$http,$store){$scope.getstarted={},$scope.viewPres=function(demo){var sessionID;$rootScope.registerMessage&&$rootScope.registerMessage.sessionId&&(sessionID=$rootScope.registerMessage.sessionId),demo&&($rootScope.userInfo={},$rootScope.userInfo.email="someemail@nowhere.com",sessionID=201,$scope.getstarted.twitter="wesleyhales",$scope.getstarted.presName="My awesome presentation",$scope.getstarted.poll1="Do you like my party hat?",$scope.getstarted.option1="Yep",$scope.getstarted.option2="Nope!"),window.open($rootScope.urls()+"/go/template/download?deckType="+$scope.getstarted.deck+"&email="+$rootScope.userInfo.email+"&sessionId="+(sessionID||"")+"&token="+$rootScope.userInfo.created+"&twitter="+$scope.getstarted.twitter+"&presName="+$scope.getstarted.presName+"&poll1="+$scope.getstarted.poll1+"&option1="+$scope.getstarted.option1+"&option2="+$scope.getstarted.option2),$store.remove("registerMessage")},$scope.setupPres=function(){$scope.getstarted.email=$rootScope.userInfo.email,$scope.getstarted.sessionId=$rootScope.registerMessage&&$rootScope.registerMessage.sessionId||"",$scope.getstarted.token=$rootScope.userInfo.created,$http({method:"POST",url:$rootScope.urls()+"/go/template/create",data:$scope.getstarted,headers:{}}).success(function(data){var frame=getFrame();frame.write(data),frame.location="#"}).error(function(data){console.log("error",data)}),$store.remove("registerMessage");var getFrame=function(){var frame=document.getElementById("temp-frame");return frame||(frame=document.createElement("iframe"),frame.setAttribute("id","temp-frame"),frame.setAttribute("name","temp-frame"),frame.setAttribute("seamless",""),frame.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms"),frame.setAttribute("height","768px"),frame.setAttribute("width","100%"),frame.setAttribute("allowFullScreen",""),document.getElementById("preview-container").appendChild(frame)),frame.contentDocument}},$scope.downloadPres=function(){$scope.getstarted.email=$rootScope.userInfo.email,$scope.getstarted.sessionId=$rootScope.registerMessage&&$rootScope.registerMessage.sessionId||"",$scope.getstarted.token=$rootScope.userInfo.created,$http({method:"GET",url:$rootScope.urls()+"/go/template/download",data:$scope.getstarted,headers:{}}).success(function(data){console.log(data)}).error(function(data){console.log("error",data)}),$store.remove("registerMessage")}}]);